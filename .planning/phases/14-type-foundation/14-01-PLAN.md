---
phase: 14-type-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - staff/shared/types/pickup-request.ts
  - staff/shared/types/gate.ts
  - customer/shared/types/pickup-request.ts
autonomous: true

must_haves:
  truths:
    - "PICKUP_STATUS constant exports all 6 status values"
    - "PickupStatus type is derived from PICKUP_STATUS constant"
    - "PickupRequest interface uses PickupStatus type for status field"
    - "ACTIVE_STATUSES and TERMINAL_STATUSES arrays are properly typed"
    - "Gate interface exists with id, gate_number, is_active fields"
  artifacts:
    - path: "staff/shared/types/pickup-request.ts"
      provides: "Pickup request types and status constants"
      exports: ["PICKUP_STATUS", "PickupStatus", "PickupRequest", "ACTIVE_STATUSES", "TERMINAL_STATUSES", "isActiveStatus"]
    - path: "staff/shared/types/gate.ts"
      provides: "Gate types"
      exports: ["Gate", "GateWithCount"]
    - path: "customer/shared/types/pickup-request.ts"
      provides: "Minimal pickup request types for customer app"
      exports: ["PICKUP_STATUS", "PickupStatus", "PickupRequest"]
  key_links:
    - from: "staff/shared/types/pickup-request.ts"
      to: "database schema"
      via: "status values match CHECK constraint"
      pattern: "pending.*approved.*in_queue.*processing.*completed.*cancelled"
---

<objective>
Create centralized TypeScript type definitions for pickup requests and gates using the `as const` pattern.

Purpose: Establish single source of truth for status values and entity types that all other files will import from.
Output: Three type definition files (staff pickup-request, staff gate, customer pickup-request) with typed constants and interfaces.
</objective>

<execution_context>
@/Users/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-type-foundation/14-RESEARCH.md

# Existing type to consolidate
@staff/app/components/dashboard/columns.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create staff shared type definitions</name>
  <files>staff/shared/types/pickup-request.ts, staff/shared/types/gate.ts</files>
  <action>
Create `staff/shared/` directory structure and type files:

1. Create `staff/shared/types/pickup-request.ts`:
   - Export `PICKUP_STATUS` as const object with keys: PENDING, APPROVED, IN_QUEUE, PROCESSING, COMPLETED, CANCELLED
   - Export `PickupStatus` type derived via `typeof PICKUP_STATUS[keyof typeof PICKUP_STATUS]`
   - Export `ACTIVE_STATUSES` array with pending, approved, in_queue, processing (use `as const satisfies readonly PickupStatus[]`)
   - Export `TERMINAL_STATUSES` array with completed, cancelled
   - Export `isActiveStatus` type guard function
   - Export `PickupRequest` interface matching current columns.ts definition but using `status: PickupStatus`

2. Create `staff/shared/types/gate.ts`:
   - Export `Gate` interface with: id, gate_number, is_active, optional created_at/updated_at
   - Export `GateWithCount` interface extending Gate with queue_count

Use the exact patterns from 14-RESEARCH.md code examples. The status values must match the database CHECK constraint: 'pending', 'approved', 'in_queue', 'processing', 'completed', 'cancelled'.
  </action>
  <verify>
Run `npx nuxi prepare staff` and verify no TypeScript errors.
Check that files exist: `ls staff/shared/types/`
  </verify>
  <done>
Both type files exist with all exports. Types are auto-imported via Nuxt #shared alias.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create customer shared type definitions</name>
  <files>customer/shared/types/pickup-request.ts</files>
  <action>
Create `customer/shared/types/pickup-request.ts` with minimal types needed by customer app:

1. Copy the PICKUP_STATUS constant and PickupStatus type from staff version (identical)
2. Create a minimal PickupRequest interface with fields the customer app actually uses:
   - id: string
   - sales_order_number: string
   - company_name: string | null
   - status: PickupStatus
   - queue_position: number | null
   - created_at: string
   - assigned_gate_id: string | null

Do NOT include staff-only fields (email_flagged, is_priority, processing_started_at) as customer app doesn't use them.

Note: In future, consider a shared workspace package. For now, duplicating minimal types is simpler and avoids cross-app complexity.
  </action>
  <verify>
Run `npx nuxi prepare customer` and verify no TypeScript errors.
Check file exists: `ls customer/shared/types/`
  </verify>
  <done>
Customer type file exists with PICKUP_STATUS, PickupStatus, and minimal PickupRequest.
  </done>
</task>

</tasks>

<verification>
1. `ls staff/shared/types/` shows pickup-request.ts and gate.ts
2. `ls customer/shared/types/` shows pickup-request.ts
3. `npx nuxi prepare staff && npx nuxi prepare customer` completes without errors
4. Types are auto-imported (can verify by checking .nuxt/types/imports.d.ts after prepare)
</verification>

<success_criteria>
- PICKUP_STATUS constant has all 6 status values matching database CHECK constraint
- PickupStatus type is properly derived (not manually written union)
- ACTIVE_STATUSES and TERMINAL_STATUSES use `as const satisfies` pattern
- PickupRequest interface uses PickupStatus type (not inline union)
- Gate interface includes id, gate_number, is_active
- Both apps can auto-import types via #shared alias
</success_criteria>

<output>
After completion, create `.planning/phases/14-type-foundation/14-01-SUMMARY.md`
</output>
