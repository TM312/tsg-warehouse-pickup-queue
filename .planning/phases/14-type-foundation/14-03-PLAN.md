---
phase: 14-type-foundation
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - staff/app/pages/index.vue
  - staff/app/pages/gate/[id].vue
  - staff/app/composables/useQueueActions.ts
  - staff/app/composables/useGateManagement.ts
autonomous: true

must_haves:
  truths:
    - "index.vue uses ACTIVE_STATUSES for filtering active requests"
    - "gate/[id].vue uses PICKUP_STATUS constants for status comparisons"
    - "useQueueActions uses PICKUP_STATUS for status updates"
    - "useGateManagement uses ACTIVE_STATUSES or PICKUP_STATUS for filtering"
    - "No magic strings remain in pages or composables"
  artifacts:
    - path: "staff/app/pages/index.vue"
      provides: "Dashboard page with typed filtering"
      contains: "ACTIVE_STATUSES"
    - path: "staff/app/composables/useQueueActions.ts"
      provides: "Queue actions with typed status updates"
      contains: "PICKUP_STATUS"
  key_links:
    - from: "staff/app/pages/index.vue"
      to: "#shared/types/pickup-request"
      via: "import ACTIVE_STATUSES"
      pattern: "import.*from '#shared/types/pickup-request'"
    - from: "staff/app/composables/useQueueActions.ts"
      to: "#shared/types/pickup-request"
      via: "import PICKUP_STATUS"
      pattern: "PICKUP_STATUS\\.(COMPLETED|CANCELLED|PROCESSING)"
---

<objective>
Migrate staff pages and composables to use centralized type definitions.

Purpose: Complete staff app migration by updating pages and composables to use typed constants.
Output: All 4 remaining staff files use imports from #shared instead of inline strings.
</objective>

<execution_context>
@/Users/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/14-type-foundation/14-01-SUMMARY.md

# Files to migrate
@staff/app/pages/index.vue
@staff/app/pages/gate/[id].vue
@staff/app/composables/useQueueActions.ts
@staff/app/composables/useGateManagement.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate staff pages</name>
  <files>staff/app/pages/index.vue, staff/app/pages/gate/[id].vue</files>
  <action>
Update both page files to use typed constants:

**index.vue (dashboard page):**
1. Add imports at top of script:
   ```typescript
   import { ACTIVE_STATUSES, TERMINAL_STATUSES } from '#shared/types/pickup-request'
   import type { PickupRequest } from '#shared/types/pickup-request'
   ```
2. Replace any inline status arrays with ACTIVE_STATUSES or TERMINAL_STATUSES
3. Replace any status string comparisons with PICKUP_STATUS constants
4. If PickupRequest is locally defined, remove it and use the imported type

**gate/[id].vue (gate operator page):**
1. Add imports at top of script:
   ```typescript
   import { PICKUP_STATUS, ACTIVE_STATUSES } from '#shared/types/pickup-request'
   import type { PickupRequest, PickupStatus } from '#shared/types/pickup-request'
   ```
2. Replace status filtering logic:
   - Change `status === 'processing'` to `status === PICKUP_STATUS.PROCESSING`
   - Change `['pending', 'approved', ...].includes()` to use ACTIVE_STATUSES
3. If PickupRequest is locally defined, remove and use imported type
  </action>
  <verify>
Run `npx nuxi typecheck staff` - no type errors
Grep: `grep -E "'pending'|'approved'|'in_queue'" staff/app/pages/` returns no matches
  </verify>
  <done>
Both page files import from #shared and use typed constants for all status operations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate staff composables</name>
  <files>staff/app/composables/useQueueActions.ts, staff/app/composables/useGateManagement.ts</files>
  <action>
Update both composable files:

**useQueueActions.ts:**
1. Add imports:
   ```typescript
   import { PICKUP_STATUS } from '#shared/types/pickup-request'
   import type { PickupRequest, PickupStatus } from '#shared/types/pickup-request'
   ```
2. Replace status string literals in API calls:
   - `status: 'completed'` -> `status: PICKUP_STATUS.COMPLETED`
   - `status: 'cancelled'` -> `status: PICKUP_STATUS.CANCELLED`
   - `status: 'processing'` -> `status: PICKUP_STATUS.PROCESSING`
3. If function parameters use inline status unions, change to PickupStatus type

**useGateManagement.ts:**
1. Add imports:
   ```typescript
   import { PICKUP_STATUS, ACTIVE_STATUSES } from '#shared/types/pickup-request'
   import type { PickupRequest } from '#shared/types/pickup-request'
   ```
2. Replace status filtering:
   - Change inline status arrays to ACTIVE_STATUSES
   - Change status comparisons to PICKUP_STATUS constants
3. If Gate type is locally defined, import from '#shared/types/gate' instead
  </action>
  <verify>
Run `npx nuxi typecheck staff` - no type errors
Grep: `grep -E "'pending'|'approved'|'completed'|'cancelled'" staff/app/composables/` returns no matches
  </verify>
  <done>
Both composables import from #shared and use PICKUP_STATUS constants for all status operations.
  </done>
</task>

</tasks>

<verification>
1. `npx nuxi typecheck staff` passes
2. `grep -rE "'pending'|'approved'|'in_queue'|'processing'|'completed'|'cancelled'" staff/app/pages/ staff/app/composables/` returns no matches
3. All files import from '#shared/types/pickup-request'
</verification>

<success_criteria>
- index.vue uses ACTIVE_STATUSES for filtering
- gate/[id].vue uses PICKUP_STATUS constants for comparisons
- useQueueActions uses PICKUP_STATUS for status updates (completed, cancelled, processing)
- useGateManagement uses ACTIVE_STATUSES or PICKUP_STATUS for filtering
- No magic status strings in any of the 4 files
</success_criteria>

<output>
After completion, create `.planning/phases/14-type-foundation/14-03-SUMMARY.md`
</output>
