---
phase: 22-quick-wins
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - staff/app/components/gates/GatesTable.vue
  - staff/app/pages/index.vue
autonomous: true

must_haves:
  truths:
    - "Gates page Open button displays as link with external arrow icon"
    - "Tab queue count badges are visually distinct from tab background"
    - "Queue view has no refresh button"
  artifacts:
    - path: "staff/app/components/gates/GatesTable.vue"
      provides: "External link button for gate view"
      contains: "ExternalLink"
    - path: "staff/app/pages/index.vue"
      provides: "Badge components for tab counts, no refresh button"
      contains: "Badge variant=\"secondary\""
      not_contains: "RefreshCw"
  key_links:
    - from: "staff/app/components/gates/GatesTable.vue"
      to: "lucide-vue-next"
      via: "ExternalLink icon import"
      pattern: "import.*ExternalLink.*from.*lucide-vue-next"
    - from: "staff/app/pages/index.vue"
      to: "@/components/ui/badge"
      via: "Badge component import"
      pattern: "import.*Badge.*from.*@/components/ui/badge"
---

<objective>
Apply three quick visual improvements: add external link icon to Gates table Open button, update tab count badges to use secondary variant for visibility, and remove the refresh button that duplicates realtime functionality.

Purpose: Clean up visual inconsistencies identified in v2.2 requirements (UI-01, UI-04, CLN-01)
Output: Updated GatesTable.vue and index.vue with improved visual treatments
</objective>

<execution_context>
@/Users/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/22-quick-wins/22-CONTEXT.md
@.planning/phases/22-quick-wins/22-RESEARCH.md
@staff/app/components/gates/GatesTable.vue
@staff/app/pages/index.vue
@staff/app/components/ui/badge/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add external link icon to Gates table Open button</name>
  <files>staff/app/components/gates/GatesTable.vue</files>
  <action>
Update GatesTable.vue to add ExternalLink icon to the Open button:

1. Add import for ExternalLink from lucide-vue-next in the script section:
   ```
   import { ExternalLink } from 'lucide-vue-next'
   ```

2. Update the NuxtLink inside the Button (around line 83-85) to:
   - Add `target="_blank"` attribute (opens in new tab - operators keep Gates overview open)
   - Add ExternalLink icon after "Open" text with class="h-4 w-4"
   - Use Button's built-in gap utility (already applied) for spacing between text and icon

Current:
```vue
<Button variant="outline" size="sm" as-child>
  <NuxtLink :to="`/gate/${gate.id}`">Open</NuxtLink>
</Button>
```

Updated:
```vue
<Button variant="outline" size="sm" as-child>
  <NuxtLink :to="`/gate/${gate.id}`" target="_blank">
    Open
    <ExternalLink class="h-4 w-4" />
  </NuxtLink>
</Button>
```

Note: NuxtLink automatically adds rel="noopener noreferrer" for target="_blank" links.
  </action>
  <verify>
Run `grep -n "ExternalLink" staff/app/components/gates/GatesTable.vue` - should show import and usage.
Run `grep -n 'target="_blank"' staff/app/components/gates/GatesTable.vue` - should show target attribute.
  </verify>
  <done>GatesTable Open button shows external link icon and opens gate view in new tab</done>
</task>

<task type="auto">
  <name>Task 2: Update tab count badges for visual distinction</name>
  <files>staff/app/pages/index.vue</files>
  <action>
Update index.vue to use Badge component with secondary variant for tab counts:

1. Add Badge import to the existing imports section (around line 6-7):
   ```
   import { Badge } from '@/components/ui/badge'
   ```

2. Replace the two `<span>` elements inside TabsTrigger components with Badge:

Current (line ~223):
```vue
<span class="ml-2 text-xs bg-muted px-1.5 py-0.5 rounded">{{ filteredRequests.length }}</span>
```

Updated:
```vue
<Badge variant="secondary" class="ml-2 tabular-nums">{{ filteredRequests.length }}</Badge>
```

Current (line ~227):
```vue
<span class="ml-2 text-xs bg-muted px-1.5 py-0.5 rounded">{{ gate.totalActive }}</span>
```

Updated:
```vue
<Badge variant="secondary" class="ml-2 tabular-nums">{{ gate.totalActive }}</Badge>
```

The `tabular-nums` class ensures monospace numbers to prevent layout shift when counts change.
The `variant="secondary"` provides subtle visual distinction from tab background (user's decision: understated, not loud).
  </action>
  <verify>
Run `grep -n "Badge.*secondary" staff/app/pages/index.vue` - should show two Badge usages with secondary variant.
Run `grep -n "tabular-nums" staff/app/pages/index.vue` - should show tabular-nums class on badges.
  </verify>
  <done>Tab badges use Badge component with secondary variant and tabular-nums for consistent appearance</done>
</task>

<task type="auto">
  <name>Task 3: Remove refresh button from queue view</name>
  <files>staff/app/pages/index.vue</files>
  <action>
Remove the refresh button and related code from index.vue:

1. Remove the RefreshCw import from the imports section (line 3):
   Delete: `import { RefreshCw } from 'lucide-vue-next'`

2. Remove the refreshing computed property (around line 68):
   Delete: `const refreshing = computed(() => requestsLoading.value)`

3. Remove the refresh Button element (lines 200-203):
   Delete:
   ```vue
   <Button variant="outline" size="sm" :disabled="refreshing" @click="refresh()">
     <RefreshCw :class="['h-4 w-4 mr-2', { 'animate-spin': refreshing }]" />
     Refresh
   </Button>
   ```

The realtime subscriptions (useRealtimeQueue) handle data freshness automatically. The ConnectionStatus indicator already shows connection state. The refresh button is redundant and was identified for removal in CLN-01.

Note: Keep the `refresh` function - it's still used by action handlers (handleGateSelect, handleComplete, etc.) for optimistic update reconciliation.
  </action>
  <verify>
Run `grep -n "RefreshCw" staff/app/pages/index.vue` - should return nothing (no matches).
Run `grep -n "refreshing" staff/app/pages/index.vue` - should return nothing.
Run `grep -n "refresh()" staff/app/pages/index.vue` - should still show refresh() calls in handlers (not the button).
  </verify>
  <done>Refresh button removed from UI, realtime subscriptions trusted for data freshness</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Type check passes:
   ```bash
   cd staff && npx nuxi typecheck
   ```

2. Visual verification (manual):
   - Visit /gates page - Open button shows external link icon, clicking opens gate view in new tab
   - Visit / (dashboard) - Tab badges have subtle visual distinction, numbers use tabular-nums
   - Dashboard header area has no Refresh button (ConnectionStatus and AddOrderDialog remain)

3. No refresh button in DOM:
   ```bash
   grep -r "Refresh" staff/app/pages/index.vue
   ```
   Should return no matches for the Refresh button text.
</verification>

<success_criteria>
- GatesTable.vue imports ExternalLink and uses it in the Open button with target="_blank"
- index.vue imports Badge and uses variant="secondary" with tabular-nums on both tab count badges
- index.vue has no RefreshCw import, no refreshing computed, and no Refresh button
- Type check passes with no new errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-quick-wins/22-01-SUMMARY.md`
</output>
