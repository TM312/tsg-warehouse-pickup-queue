---
phase: 16-sidebar-layout
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - staff/app/layouts/fullscreen.vue
  - staff/app/pages/gate/[id].vue
autonomous: true

must_haves:
  truths:
    - "Gate operator routes (/gate/[id]) render fullscreen without sidebar"
    - "Gate page preserves all existing functionality (pickup workflow, realtime updates)"
    - "Gate page navigation back to dashboard works"
  artifacts:
    - path: "staff/app/layouts/fullscreen.vue"
      provides: "Minimal layout without sidebar for gate operators"
      min_lines: 5
    - path: "staff/app/pages/gate/[id].vue"
      provides: "Gate operator page using fullscreen layout"
      contains: "layout: 'fullscreen'"
  key_links:
    - from: "staff/app/pages/gate/[id].vue"
      to: "staff/app/layouts/fullscreen.vue"
      via: "definePageMeta layout property"
      pattern: "layout:\\s*['\"]fullscreen['\"]"
---

<objective>
Create a fullscreen layout for gate operator routes and update the gate page to use it.

Purpose: Gate operator routes (/gate/[id]) are designed for mobile operators and should render without the sidebar navigation. This requires a separate minimal layout that preserves only essential functionality (background, slot for content).

Output: New fullscreen.vue layout and updated gate page meta to use it.
</objective>

<execution_context>
@/Users/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-sidebar-layout/16-CONTEXT.md
@.planning/phases/16-sidebar-layout/16-RESEARCH.md
@staff/app/layouts/default.vue
@staff/app/pages/gate/[id].vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create fullscreen layout</name>
  <files>staff/app/layouts/fullscreen.vue</files>
  <action>
Create a minimal fullscreen layout for gate operator routes. This layout should:

1. Have minimal wrapper (just background styling)
2. Use slot for page content (no header, no sidebar)
3. Match the existing gate page's min-h-screen approach

Create staff/app/layouts/fullscreen.vue:
```vue
<template>
  <div class="min-h-screen bg-background">
    <slot />
  </div>
</template>
```

This is intentionally minimal - the gate page already has its own header and layout structure.
  </action>
  <verify>
Verify the layout file exists:
```bash
cat staff/app/layouts/fullscreen.vue
```
Should show the minimal template with slot.
  </verify>
  <done>fullscreen.vue layout exists with minimal wrapper and slot for content</done>
</task>

<task type="auto">
  <name>Task 2: Update gate page to use fullscreen layout</name>
  <files>staff/app/pages/gate/[id].vue</files>
  <action>
Update the definePageMeta in staff/app/pages/gate/[id].vue to specify the fullscreen layout.

Current definePageMeta:
```ts
definePageMeta({
  middleware: 'auth'
})
```

Change to:
```ts
definePageMeta({
  layout: 'fullscreen',
  middleware: 'auth'
})
```

This tells Nuxt to use layouts/fullscreen.vue instead of layouts/default.vue for this page. The middleware remains to ensure authentication is required.

IMPORTANT: Do not modify any other part of the gate page. All existing functionality must be preserved:
- Pickup workflow (start processing, complete, revert)
- Realtime updates via store watcher
- Gate loading/error states
- Next up preview
- Dialog confirmations
  </action>
  <verify>
Verify the definePageMeta includes layout:
```bash
grep -A 3 "definePageMeta" staff/app/pages/gate/[id].vue
```
Should show `layout: 'fullscreen'` in the meta.

Verify the page still runs:
```bash
cd staff && npx nuxi typecheck 2>&1 | head -50
```
No type errors related to the gate page.
  </verify>
  <done>Gate page definePageMeta includes layout: 'fullscreen' while preserving middleware: 'auth'</done>
</task>

</tasks>

<verification>
1. Fullscreen layout exists and is minimal:
```bash
cat staff/app/layouts/fullscreen.vue
```

2. Gate page uses fullscreen layout:
```bash
grep -A 5 "definePageMeta" staff/app/pages/gate/[id].vue
```

3. App starts without errors:
```bash
cd staff && npx nuxi dev --no-fork &
sleep 5
curl -s http://localhost:3000 | head -20
kill %1
```
</verification>

<success_criteria>
1. staff/app/layouts/fullscreen.vue exists with minimal template (div with bg-background, slot)
2. staff/app/pages/gate/[id].vue has definePageMeta with layout: 'fullscreen'
3. Gate page preserves middleware: 'auth' in definePageMeta
4. TypeScript compilation passes
5. Gate page existing functionality is unchanged (only meta added)
</success_criteria>

<output>
After completion, create `.planning/phases/16-sidebar-layout/16-02-SUMMARY.md`
</output>
