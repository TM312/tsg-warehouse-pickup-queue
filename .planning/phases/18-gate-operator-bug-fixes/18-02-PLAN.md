---
phase: 18-gate-operator-bug-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - staff/app/components/dashboard/ShowCompletedToggle.vue
  - staff/app/layouts/fullscreen.vue
autonomous: true

must_haves:
  truths:
    - "Show completed/cancelled toggle updates list when clicked"
    - "Gate page does not scroll when content fits viewport on mobile"
  artifacts:
    - path: "staff/app/components/dashboard/ShowCompletedToggle.vue"
      provides: "Fixed toggle with v-model binding"
      contains: "v-model"
    - path: "staff/app/layouts/fullscreen.vue"
      provides: "Mobile viewport fix with svh unit"
      contains: "svh"
  key_links:
    - from: "staff/app/components/dashboard/ShowCompletedToggle.vue"
      to: "Switch component"
      via: "v-model directive"
      pattern: "v-model"
---

<objective>
Fix two bugs: the filter toggle not updating the queue list, and mobile viewport scrolling when content fits.

Purpose: Resolve BUG-01 (filter toggle) and GATE-13 (mobile viewport)
Output: Working toggle filter and proper mobile viewport behavior
</objective>

<execution_context>
@/Users/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/18-gate-operator-bug-fixes/18-RESEARCH.md

# Files to fix
@staff/app/components/dashboard/ShowCompletedToggle.vue
@staff/app/layouts/fullscreen.vue
@staff/app/components/ui/switch/Switch.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ShowCompletedToggle v-model binding (BUG-01)</name>
  <files>staff/app/components/dashboard/ShowCompletedToggle.vue</files>
  <action>
The bug: reka-ui Switch emits `update:modelValue` but the component uses `:checked` + `@update:checked`.

Fix by migrating to Vue 3.4+ defineModel pattern:

Before (broken):
```vue
<Switch
  :checked="showCompleted"
  @update:checked="$emit('update:showCompleted', $event)"
/>
...
defineProps<{ showCompleted: boolean }>()
defineEmits<{ 'update:showCompleted': [value: boolean] }>()
```

After (working):
```vue
<Switch v-model="showCompleted" />
...
const showCompleted = defineModel<boolean>('showCompleted', { default: false })
```

Remove the props and emits definitions since defineModel handles both.
Keep the existing template structure (flex, gap, label text).
  </action>
  <verify>
TypeScript compiles: `cd staff && npx nuxi typecheck 2>&1 | head -30`
  </verify>
  <done>
Toggle updates list when clicked (v-model correctly bound to reka-ui Switch)
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix mobile viewport scrolling (GATE-13)</name>
  <files>staff/app/layouts/fullscreen.vue</files>
  <action>
The bug: `min-h-screen` (100vh) on iOS Safari includes the address bar height, causing scroll when content actually fits.

Fix by using `svh` (small viewport height) unit which accounts for mobile browser chrome.

Current:
```vue
<div class="min-h-screen bg-background">
```

Update to:
```vue
<div class="min-h-[100svh] bg-background">
```

This uses Tailwind arbitrary value syntax for svh.

Note: Modern browser support is excellent (Safari 15.4+, Chrome 108+). No fallback needed for this app's target audience (warehouse staff on relatively modern devices).
  </action>
  <verify>
Check CSS output includes svh: `grep -r "svh" staff/app/layouts/fullscreen.vue`
  </verify>
  <done>
Fullscreen layout uses svh for proper mobile viewport sizing
  </done>
</task>

</tasks>

<verification>
- [ ] ShowCompletedToggle uses `v-model` and `defineModel` pattern
- [ ] fullscreen.vue uses `min-h-[100svh]` instead of `min-h-screen`
- [ ] TypeScript compilation passes
</verification>

<success_criteria>
BUG-01 and GATE-13 resolved - toggle works and mobile viewport doesn't scroll unnecessarily
</success_criteria>

<output>
After completion, create `.planning/phases/18-gate-operator-bug-fixes/18-02-SUMMARY.md`
</output>
