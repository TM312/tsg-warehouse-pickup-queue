---
phase: 18-gate-operator-bug-fixes
plan: 03
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - staff/app/pages/gate/[id].vue
autonomous: false

must_haves:
  truths:
    - "Gate operator can navigate to previous/next gate via buttons"
    - "Gate order follows alphabetical sorting (consistent ordering)"
    - "Left/right arrow keys navigate between gates"
    - "Keyboard navigation does not interfere with form inputs"
  artifacts:
    - path: "staff/app/pages/gate/[id].vue"
      provides: "Gate page with navigation buttons in header"
      contains: "GateNavButtons"
  key_links:
    - from: "staff/app/pages/gate/[id].vue"
      to: "GateNavButtons"
      via: "component import"
      pattern: "GateNavButtons"
    - from: "staff/app/pages/gate/[id].vue"
      to: "useGatesStore"
      via: "gates store for data"
      pattern: "useGatesStore"
---

<objective>
Integrate gate navigation into the gate operator page header and verify all phase requirements work correctly.

Purpose: Complete GATE-12 (prev/next navigation) and verify full phase functionality
Output: Working gate navigation with buttons and keyboard, verified by human testing
</objective>

<execution_context>
@/Users/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/18-gate-operator-bug-fixes/18-RESEARCH.md
@.planning/phases/18-gate-operator-bug-fixes/18-01-SUMMARY.md

# Files to modify
@staff/app/pages/gate/[id].vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate GateNavButtons into gate page header</name>
  <files>staff/app/pages/gate/[id].vue</files>
  <action>
Replace the static gate header with the GateNavButtons component.

Current header (around line 191-196):
```vue
<header class="bg-primary text-primary-foreground p-4">
  <h1 class="text-2xl font-bold text-center">Gate {{ gate.gate_number }}</h1>
  ...
</header>
```

Updated header:
```vue
<header class="bg-primary text-primary-foreground p-4">
  <div class="flex justify-center">
    <GateNavButtons :current-gate="gate" />
  </div>
  <p v-if="realtimeStatus !== 'connected'" class="text-xs text-amber-200 text-center mt-1">
    {{ realtimeStatus === 'connecting' ? 'Connecting...' : 'Reconnecting...' }}
  </p>
</header>
```

Import the GateNavButtons component at the top of the script.

Note: The GateNavButtons component internally calls useGateNavigation which sets up keyboard handlers. This happens automatically when the component mounts, and cleans up when it unmounts.
  </action>
  <verify>
TypeScript compiles: `cd staff && npx nuxi typecheck 2>&1 | head -30`
  </verify>
  <done>
Gate page header shows navigation buttons with prev/next gate controls
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 18 implementation:
1. Gate navigation with prev/next buttons and keyboard shortcuts (GATE-12)
2. Mobile viewport fix for gate page (GATE-13)
3. Filter toggle bug fix (BUG-01)
  </what-built>
  <how-to-verify>
**Test GATE-12 (Gate Navigation):**
1. Start dev server: `cd staff && npm run dev`
2. Navigate to a gate page (e.g., /gate/[first-gate-id])
3. Verify prev/next buttons appear in header alongside gate name
4. Click next button - should navigate to next gate
5. Click prev button - should navigate to previous gate
6. Verify wrap-around: on last gate, click next -> goes to first gate
7. Test keyboard: press right arrow -> navigates to next gate
8. Test keyboard: press left arrow -> navigates to previous gate
9. Verify keyboard doesn't trigger when typing in any input (if there are any on page)

**Test GATE-13 (Mobile Viewport):**
1. Open gate page on mobile device or Chrome DevTools mobile emulation
2. With minimal queue content, page should not scroll
3. Content should fit exactly within visible viewport

**Test BUG-01 (Filter Toggle):**
1. Navigate to main dashboard (/)
2. Find the "Show completed/cancelled" toggle
3. Toggle it on -> completed/cancelled items should appear in list
4. Toggle it off -> completed/cancelled items should disappear
5. Confirm toggle responds immediately to clicks
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
- [ ] GateNavButtons integrated into gate page header
- [ ] Navigation buttons visible and functional
- [ ] Keyboard shortcuts work (left/right arrows)
- [ ] Mobile viewport doesn't scroll unnecessarily
- [ ] Filter toggle updates list when clicked
- [ ] Human verification passed
</verification>

<success_criteria>
All Phase 18 requirements verified:
- GATE-12: Prev/next navigation works with buttons and keyboard
- GATE-13: Mobile viewport sized correctly
- BUG-01: Filter toggle updates list
</success_criteria>

<output>
After completion, create `.planning/phases/18-gate-operator-bug-fixes/18-03-SUMMARY.md`
</output>
